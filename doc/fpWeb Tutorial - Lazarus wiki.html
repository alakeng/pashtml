<!DOCTYPE html>
<html class="client-js" dir="ltr" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>fpWeb Tutorial - Lazarus wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"fpWeb_Tutorial","wgTitle":"fpWeb Tutorial","wgCurRevisionId":136392,"wgRevisionId":136392,"wgArticleId":16163,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Tutorials","FPC","Lazarus","Networking"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"fpWeb_Tutorial","wgRelevantArticleId":16163,"wgRequestId":"f9fa64cc66d13226ff79bfc8","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgSmjSize":110,"wgSmjUseChem":true,"wgSmjInlineMath":[["[math]","[/math]"]]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","site":"ready","user.options":"ready","user.tokens":"loading","ext.pygments":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","mediawiki.skinning.content.externallinks":"ready","skins.monobook.styles":"ready"});mw.loader.implement("user.tokens@189iure",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["ext.SmjCDN","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest"]);});</script>
<link rel="stylesheet" href="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/load.css">
<script async="" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/load_002.php"></script>
<!--[if IE 6]><link rel="stylesheet" href="/skins/MonoBook/resources/IE60Fixes.css?303" media="screen"/><![endif]--><!--[if IE 7]><link rel="stylesheet" href="/skins/MonoBook/resources/IE70Fixes.css?303" media="screen"/><![endif]-->
<style>
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:0;z-index:1099;padding:0;margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:#fff;cursor:pointer;border:1px solid #a2a9b1;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:#fff;cursor:pointer;border:1px solid #a2a9b1;padding:0;margin:0}.suggestions-result{color:#000;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left; overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.suggestions-result-current{background-color:#2a4b8d;color:#fff}.suggestions-special .special-label{color:#72777d;text-align:left}.suggestions-special .special-query{color:#000;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:#c8ccd1}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:#fff}.highlight{font-weight:bold}
@media screen {
	.tochidden,.toctoggle{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.toctoggle{font-size:94%}}
@media print {
	.toc.tochidden,.toctoggle{display:none}}</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{color:#000;text-decoration:none}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:#fff}.suggestions a.mw-searchSuggest-link .special-query{ overflow:hidden;text-overflow:ellipsis;white-space:nowrap}</style><meta name="ResourceLoaderDynamicStyles" content="">
<link rel="stylesheet" href="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/load_002.css">
<meta name="generator" content="MediaWiki 1.31.7">
<link rel="shortcut icon" href="https://wiki.freepascal.org/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.freepascal.org/opensearch_desc.php" title="Lazarus wiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.lazarus.freepascal.org/api.php?action=rsd">
<link rel="license" href="https://sourceforge.net/">
<link rel="alternate" type="application/atom+xml" title="Lazarus wiki Atom feed" href="https://wiki.freepascal.org/index.php?title=Special:RecentChanges&amp;feed=atom">
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=MonoBook&amp;sync=1"></script><![endif]-->
<script src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/load.php"></script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style></head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-fpWeb_Tutorial rootpage-fpWeb_Tutorial skin-monobook action-view"><div id="MathJax_Message" style="display: none;"></div><div id="globalWrapper"><div id="column-content"><div id="content" class="mw-body" role="main"><a id="top"></a><div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">fpWeb Tutorial</h1><div id="bodyContent" class="mw-body-content"><div id="siteSub">From Lazarus wiki</div><div id="contentSub" dir="ltr" lang="en"></div><div id="jump-to-nav" class="mw-jump">Jump to:<a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div><!-- start content --><div id="mw-content-text" dir="ltr" class="mw-content-ltr" lang="en"><div class="mw-parser-output"><pre> Source: fcl-web tutorial (in pdf) by Leledumbo
</pre>
<div id="toc" class="toc"><div class="toctitle" dir="ltr" lang="en"><h2>Contents</h2><span class="toctoggle">&nbsp;[<a role="button" tabindex="0" class="togglelink">hide</a>]&nbsp;</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Architecture_.28PLEASE_read.29"><span class="tocnumber">2</span> <span class="toctext">Architecture (PLEASE read)</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Application"><span class="tocnumber">2.1</span> <span class="toctext">Application</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Web_Modules"><span class="tocnumber">2.2</span> <span class="toctext">Web Modules</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Installation"><span class="tocnumber">3</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Specialized_modules"><span class="tocnumber">4</span> <span class="toctext">Specialized modules</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Hello.2C_World.21"><span class="tocnumber">5</span> <span class="toctext">Hello, World!</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Reading_GET_.26_POST_data"><span class="tocnumber">6</span> <span class="toctext">Reading GET &amp; POST data</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Reading_GET"><span class="tocnumber">6.1</span> <span class="toctext">Reading GET</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Reading_POST"><span class="tocnumber">6.2</span> <span class="toctext">Reading POST</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Reading_File_Uploads"><span class="tocnumber">6.3</span> <span class="toctext">Reading File Uploads</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Cookies"><span class="tocnumber">7</span> <span class="toctext">Cookies</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Setting"><span class="tocnumber">7.1</span> <span class="toctext">Setting</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Getting"><span class="tocnumber">7.2</span> <span class="toctext">Getting</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#Sessions"><span class="tocnumber">8</span> <span class="toctext">Sessions</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Activating"><span class="tocnumber">8.1</span> <span class="toctext">Activating</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Session_Variables_Manipulation"><span class="tocnumber">8.2</span> <span class="toctext">Session Variables Manipulation</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Terminating"><span class="tocnumber">8.3</span> <span class="toctext">Terminating</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19"><a href="#Routing"><span class="tocnumber">9</span> <span class="toctext">Routing</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Old_Mechanism"><span class="tocnumber">9.1</span> <span class="toctext">Old Mechanism</span></a>
<ul>
<li class="toclevel-3 tocsection-21"><a href="#Using_Multiple_Modules"><span class="tocnumber">9.1.1</span> <span class="toctext">Using Multiple Modules</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#Using_Actions"><span class="tocnumber">9.1.2</span> <span class="toctext">Using Actions</span></a>
<ul>
<li class="toclevel-4 tocsection-23"><a href="#Request_Handling_Flow"><span class="tocnumber">9.1.2.1</span> <span class="toctext">Request Handling Flow</span></a></li>
<li class="toclevel-4 tocsection-24"><a href="#Add_Actions_to_Web_Modules"><span class="tocnumber">9.1.2.2</span> <span class="toctext">Add Actions to Web Modules</span></a></li>
<li class="toclevel-4 tocsection-25"><a href="#Default_Action"><span class="tocnumber">9.1.2.3</span> <span class="toctext">Default Action</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-26"><a href="#New_Mechanism"><span class="tocnumber">9.2</span> <span class="toctext">New Mechanism</span></a>
<ul>
<li class="toclevel-3 tocsection-27"><a href="#Route_Syntax"><span class="tocnumber">9.2.1</span> <span class="toctext">Route Syntax</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Registering_a_Route"><span class="tocnumber">9.2.2</span> <span class="toctext">Registering a Route</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#Using_Templates"><span class="tocnumber">10</span> <span class="toctext">Using Templates</span></a>
<ul>
<li class="toclevel-2 tocsection-30"><a href="#At_Action_Level"><span class="tocnumber">10.1</span> <span class="toctext">At Action Level</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#At_Module_Level"><span class="tocnumber">10.2</span> <span class="toctext">At Module Level</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Using_Separated_Template"><span class="tocnumber">10.3</span> <span class="toctext">Using Separated Template</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-33"><a href="#Using_an_html_Producer_object"><span class="tocnumber">11</span> <span class="toctext">Using an html Producer object</span></a></li>
<li class="toclevel-1 tocsection-34"><a href="#Tips_and_Tricks"><span class="tocnumber">12</span> <span class="toctext">Tips and Tricks</span></a>
<ul>
<li class="toclevel-2 tocsection-35"><a href="#Returning_Different_HTTP_Response_Code"><span class="tocnumber">12.1</span> <span class="toctext">Returning Different HTTP Response Code</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Redirect_Request_to_Different_URL"><span class="tocnumber">12.2</span> <span class="toctext">Redirect Request to Different URL</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Serving_Static_Files_.28Embedded_Web_Server.29"><span class="tocnumber">12.3</span> <span class="toctext">Serving Static Files (Embedded Web Server)</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Centralize_Management_of_Configuration_and_Modules"><span class="tocnumber">12.4</span> <span class="toctext">Centralize Management of Configuration and Modules</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Terminating_Gracefully_.28FastCGI_.2F_Embedded_Web_Server.29"><span class="tocnumber">12.5</span> <span class="toctext">Terminating Gracefully (FastCGI / Embedded Web Server)</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Custom_Exception_Handler"><span class="tocnumber">12.6</span> <span class="toctext">Custom Exception Handler</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Pure_Hand_Coding_.28No_Form_Designer_Required.29"><span class="tocnumber">12.7</span> <span class="toctext">Pure Hand Coding (No Form Designer Required)</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#See_also"><span class="tocnumber">12.8</span> <span class="toctext">See also</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>fpWeb is a web application framework shipped by FPC in its default distribution as a part of fcl-web
package. The framework itself is built on top of fcl-web features. The framework is built with RAD mind to
make a good use of componentization in producing dynamic content. A Lazarus package is provided that
can use the framework in a drag n drop manner for its session management and content production.
This tutorial will attempt to cover basic functionality of fpWeb, so that one can build common web
application with it. Note that this tutorial does <b>NOT</b> attempt to teach HTTP protocol, HTML, CSS, JavaScript
or database manipulation as the protocol and client languages should be the prerequisites for every web
application programmer and database manipulation does not differ from desktop implementation.
</p>
<h2><span id="Architecture_(PLEASE_read)"></span><span class="mw-headline" id="Architecture_.28PLEASE_read.29">Architecture (PLEASE read)</span></h2>
<p>Before starting, it's necessary to know the architecture and application flow to avoid confusion when certain
things don't work or work unexpectedly. So please spend some time reading this section.
</p>
<h3><span class="mw-headline" id="Application">Application</span></h3>
<p>Application here refers to the protocol that your app will implement. fpWeb will happily switch from CGI,
FCGI, Apache module to embedded server, and more if fcl-web implements another one in the future. Each
application is implemented in its own unit, so to switch from one application to another, with the exception
of Apache module, one just needs to change the respective identifier in the uses clause. Currently (as of
3.0.0 / 3.1.1), they are:
</p>
<ul><li>fpCGI -&gt; CGI</li>
<li>fpFCGI -&gt; FastCGI</li>
<li>fpApache (requires httpd as well) -&gt; Apache module</li>
<li>fpHttpApp -&gt; embedded server</li>
<li>microhttpapp -&gt; embedded server using GNU libmicrohttp library.</li>
<li>fphttpsys -&gt; Windows system support for HTTP protocol.</li></ul>
<p>Throughout this tutorial, we will use embedded server for the sake of simplicity because you don't have to
deal with setting up virtual server and messing up with complicated configuration file and service
management. Your app will be a single binary portable web application! Another reason would be there are
more than just one web server application out there and each has different way to configure. It would be
overkill to cover all of them while their documentation already does the job.
Apache module is implemented as a (dynamic) library, while other protocols are normal application. Each
application may have specific properties (such as port) available and meaningful only to that application.
That's why if you look at fcl-web examples, .lpi / .lpr pairs for each protocol are put in their own directories,
only the web modules are shared.
</p>
<h3><span class="mw-headline" id="Web_Modules">Web Modules</span></h3>
<div class="thumb tright"><div class="thumbinner" style="width:302px;"><a href="https://wiki.freepascal.org/File:fpWeb-overview.png" class="image"><img alt="fpWeb-overview.png" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpWeb-overview.png" class="thumbimage" width="300" height="176"></a>  <div class="thumbcaption"><div class="magnify"><a href="https://wiki.freepascal.org/File:fpWeb-overview.png" class="internal" title="Enlarge"></a></div></div></div></div>
<p>fpWeb applications consist of web modules which does the actual content production. Web module can
contain web actions that can divide the functionality even more specific. For instance, an auth web module
might have login and logout web actions. While an about web module might not need an action at all and
serves just one content. Web module is integrated with fpTemplate that can be used for producing dynamic
content from a template file. This is roughly similar to what PHP does, only the gap between logic and
presentation is forced rather than suggested. Some say that fpTemplate implements passive view while PHP
by default implements active view design pattern.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>The fpWeb package for Lazarus is not installed by default (but it's shipped), to enable fpWeb:
</p>
<ol><li>Open Lazarus and choose <b>Package-&gt;Install/Uninstall Package</b></li>
<li>In the Available for installation listbox, look for <b>weblaz</b> and press <b>Install selection</b>. Press <b>Save and rebuild IDE</b> and confirm with <b>Continue</b></li>
<li>Let the IDE rebuild and restart itself. If everything goes well, you
 should now have fpWeb tab in the component palette, as shown below:</li></ol>
<dl><dd><dl><dd><a href="https://wiki.freepascal.org/File:fpwebtutorial_inst.png" class="image" title="Installed weblaz package"><img alt="Installed weblaz package" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_inst.png" width="615" height="606"></a></dd></dl></dd></dl>
<h2><span class="mw-headline" id="Specialized_modules">Specialized modules</span></h2>
<p>The *TFPWebModule* class (used below) is a simple example of a fpWEB module that can be used for all kinds of HTTP requests.
</p><p>However, fpWEB comes with some specialized modules, that have extra support for specialized tasks:
</p>
<ul><li>The <b>TSimpleFileModule</b> class in unit <i>fpwebfile.pp</i> can be used to send files. You point it to a directory, and it does the rest.</li>
<li>The <b>TFPHTMLModule</b> class in unit <i>fphtml.pp</i> can be used to produce HTML.</li>
<li>The <b>TProxyWebModule</b> class in unit <i>fpwebproxy.pp</i> is a ready-made forwarding proxy.</li>
<li>The <b>TFPWebProviderDataModule</b> class in unit <i>fpwebdata.pp</i> serves data in JSON format that can be consumed by ExtJS stores.</li>
<li>The <b>TSQLDBRestModule</b> class in unit <i>sqldbrestmodule.pp</i> implements a full REST server backed by SQLDB. See more info in <a href="https://wiki.freepascal.org/SQLDBRestBridge" title="SQLDBRestBridge">SQLDBRestBridge</a>.</li>
<li>The <b>TJSONRPCModule</b> class in unit <i>webjsonrpc.pp</i> implements a JSON-RPC service.</li>
<li>The <b>TExtDirectModule</b> class in unit <i>fpextdirect.pp</i> implements a Ext.Direct variant of a JSON-RPC service.</li></ul>
<h2><span id="Hello,_World!"></span><span class="mw-headline" id="Hello.2C_World.21">Hello, World!</span></h2>
<p>Let's create a simple Web Application. As commonly taught when learning programming, "Hello, World!" will be our first app.<br><br>
</p><p>1. Open up Lazarus and choose <b>Project-&gt;New Project</b> then pick <b>HTTP server Application</b>
</p>
<dl><dd><a href="https://wiki.freepascal.org/File:fpwebtutorial_create_app.png" class="image" title="Create new HTTP server application"><img alt="Create new HTTP server application" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_create_app.png" width="569" height="330"></a><br></dd></dl>
<p>2. Another dialog shall appear for serving static files, port selection and multithreading. Just use default port 8080.
</p>
<dl><dd><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">You</span> <span class="n">may</span> <span class="n">skip</span> <span class="n">the</span> <span class="n">static</span> <span class="n">files</span> <span class="n">serving</span> <span class="p">(</span><span class="n">go</span> <span class="k">to</span> <span class="n">tips</span> <span class="k">and</span> <span class="n">tricks</span> <span class="n">section</span> <span class="k">if</span> <span class="n">you</span> <span class="n">want</span> <span class="k">to</span> <span class="n">know</span> <span class="n">it</span> <span class="n">more</span><span class="p">)</span><span class="o">.</span>
</pre></div></dd>
<dd><a href="https://wiki.freepascal.org/File:fpwebtutorial_port_selection.PNG" class="image" title="Static files, port selection and multithreading options"><img alt="Static files, port selection and multithreading options" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_port_selection.PNG" width="393" height="340"></a></dd></dl>
<p><br>
</p>
<dl><dd><b>IMPORTANT!:</b></dd>
<dd>If you choose to use threads on *nix, don't forget to add cthreads 
as the first unit in the .lpr's uses clause, otherwise a RTE 232 will be
 generated. When running from console, a message shall appear:</dd>
<dd><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">This</span> <span class="n">binary</span> <span class="n">has</span> <span class="n">no</span> <span class="n">thread</span> <span class="n">support</span> <span class="n">compiled</span> <span class="k">in</span><span class="o">.</span> <span class="n">Recompile</span> <span class="n">the</span> <span class="n">application</span> <span class="k">with</span> <span class="n">a</span> <span class="n">thread</span><span class="o">-</span><span class="n">driver</span> <span class="k">in</span> <span class="n">the</span> <span class="k">program</span> <span class="k">uses</span> <span class="n">clause</span> <span class="n">before</span> <span class="n">other</span> <span class="n">units</span> <span class="n">using</span> <span class="n">thread</span><span class="o">.</span>
</pre></div></dd></dl>
<p><br>
3. Since&nbsp;Jan 14, 2017&nbsp;(or FPC 3.0.4), you may need to open the
 .lpr and add the following line in the main body if it's not already 
there:
</p>
<dl><dd><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Application</span><span class="o">.</span><span class="n">LegacyRouting</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
</pre></div></dd>
<dd>reason will be explained in chapter&nbsp;<a href="#Routing">#Routing</a>.</dd></dl>
<p><br>
4. Whatever you choose, pick "OK" and you'll be presented in the default one module fpWeb app. <br>
</p><p>5. Focus the module and move to <b>Object Inspector</b>. Feel free to rename the module if you wish.<br>
</p><p>6. Choose <b>Events</b> tab and click the button at the right of the second column of the <b>OnRequest</b> row to create the event handler.
</p>
<dl><dd><a href="https://wiki.freepascal.org/File:fpwebtutorial_on_request.png" class="image" title="Creating web module's OnRequest handler in the object inspector"><img alt="Creating web module's OnRequest handler in the object inspector" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_on_request.png" width="268" height="429"></a><br></dd></dl>
<dl><dd>You will be redirected to the source editor with the following code:</dd>
<dd><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">DataModuleRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
<span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="err">|</span>
<span class="k">end</span><span class="o">;</span>
</pre></div></dd></dl>
<dl><dd>Fill in the event with:</dd></dl>
<dl><dd><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">DataModuleRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
<span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">AResponse</span><span class="o">.</span><span class="n">Content</span> <span class="o">:=</span> <span class="s">'Hello, World!'</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div><br></dd></dl>
<p>7. Then run your app (or press F9).<br>
</p><p>8. Open your browser and type:
</p>
<dl><dd><a rel="nofollow" class="external free" href="http://localhost:8080/">http://localhost:8080/</a> <br></dd></dl>
<p>9. You should see "Hello, World!" displayed.<br>
<br>
</p><p>If it doesn't, check below:
</p>
<ul><li>The framework does a lot of exception handling and the IDE's 
debugger might catch them and interrupts your app. It's OK to add most 
of the exceptions to the ignore list so you can concentrate more on  
your app flow. Keep skipping and continue until no more dialog appears 
and the browser shows the output.</li></ul>
<ul><li><b>Handled&nbsp;:= true</b> is the way we tell the framework that the request has been handled. Not setting it (or setting it to <b>false</b>)
 will show error page instead. For now, this doesn't affect the request 
flow yet, but it will be later on. So keep it that way until the time 
comes to further make a good use of it.</li></ul>
<ul><li>other track: test without a firewall loaded in RAM (as an application, as a service or deamon, or as both).</li></ul>
<h2><span id="Reading_GET_&amp;_POST_data"></span><span class="mw-headline" id="Reading_GET_.26_POST_data">Reading GET &amp; POST data</span></h2>
<p>A dynamic content is likely to be triggered from user input, either through forms, providing values in the
URL, etc. Those data are sent along the request, which is represented in the method as <b>ARequest</b>
parameter of type <b>TRequest</b>.
</p>
<h3><span class="mw-headline" id="Reading_GET">Reading GET</span></h3>
<p>GET data is provided as <b>ARequest.QueryFields</b> , which is a <b>TStrings</b> descendant. In short, whatever you
usually do with TStrings, is applicable here such as accessing the data in a map style through the <b>Values</b>
property.
</p><p>Reusing above code, replace the method body with:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">DataModuleRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
 <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">var</span>
  <span class="n">LName</span><span class="o">:</span> <span class="k">String</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">LName</span> <span class="o">:=</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">QueryFields</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="s">'Name'</span><span class="p">]</span><span class="o">;</span>
  <span class="k">if</span> <span class="n">LName</span> <span class="o">=</span> <span class="n">EmptyStr</span> <span class="k">then</span>
    <span class="k">with</span> <span class="n">AResponse</span><span class="o">.</span><span class="n">Contents</span> <span class="k">do</span>
    <span class="k">begin</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;form action="'</span> <span class="o">+</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">URI</span> <span class="o">+</span> <span class="s">'" method="GET"'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;label for="name"&gt;Please tell me your name:&lt;/label&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;input type="text" name="name" id="name" /&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;input type="submit" value="Send" /&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;/form&gt;'</span><span class="p">)</span><span class="o">;</span>
    <span class="k">end</span>
  <span class="k">else</span>
    <span class="n">AResponse</span><span class="o">.</span><span class="n">Content</span> <span class="o">:=</span> <span class="s">'Hello, '</span> <span class="o">+</span> <span class="n">LName</span> <span class="o">+</span> <span class="s">'!'</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p><b>ARequest.URI</b> is just a convenience to refer to the current URI, so even when you change your registered
module or action name, this code stays the same.
</p><p>Note that as in Pascal, referring to the data is done case insensitively.
</p><p>Now you can try requesting /, which will display
</p>
<pre> Please tell me your name
</pre>
<p>and /?name=&lt;write anything here, e.g.: Bob&gt;, which will display
</p>
<pre> Hello, Bob!
</pre>
<h3><span class="mw-headline" id="Reading_POST">Reading POST</span></h3>
<p>POST is actually doesn't differ much from GET, only differs in which property to access. If GET is accessed
through <b>ARequest.QueryFields</b> , POST is accessed through <b>ARequest.ContentFields</b>. POST style of
previous code is:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">DataModuleRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
 <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">var</span>
  <span class="n">LName</span><span class="o">:</span> <span class="k">String</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">LName</span> <span class="o">:=</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">ContentFields</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="s">'Name'</span><span class="p">]</span><span class="o">;</span>
  <span class="k">if</span> <span class="n">LName</span> <span class="o">=</span> <span class="n">EmptyStr</span> <span class="k">then</span>
    <span class="k">with</span> <span class="n">AResponse</span><span class="o">.</span><span class="n">Contents</span> <span class="k">do</span>
    <span class="k">begin</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;form action="'</span> <span class="o">+</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">URI</span> <span class="o">+</span> <span class="s">'" method="POST"'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;label for="name"&gt;Please tell me your name:&lt;/label&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;input type="text" name="name" id="name" /&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;input type="submit" value="Send" /&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;/form&gt;'</span><span class="p">)</span><span class="o">;</span>
    <span class="k">end</span>
  <span class="k">else</span>
    <span class="n">AResponse</span><span class="o">.</span><span class="n">Content</span> <span class="o">:=</span> <span class="s">'Hello, '</span> <span class="o">+</span> <span class="n">LName</span> <span class="o">+</span> <span class="s">'!'</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<h3><span class="mw-headline" id="Reading_File_Uploads">Reading File Uploads</span></h3>
<p>One exception is for reading <b>multipart/form-data</b> fields, i.e. files. That one is available in
<b>ARequest.Files</b> as a <b>TUploadedFiles</b> instance, which is a <b>TCollection</b> descendant. The following is
TUploadedFiles public interface which you can use to access the files:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">TUploadedFiles</span> <span class="o">=</span> <span class="k">Class</span><span class="p">(</span><span class="n">TCollection</span><span class="p">)</span>
<span class="o">...</span>
<span class="kp">public</span>
  <span class="k">Function</span> <span class="nf">First</span><span class="o">:</span> <span class="n">TUploadedFile</span><span class="o">;</span>
  <span class="k">Function</span> <span class="nf">Last</span><span class="o">:</span> <span class="n">TUploadedFile</span><span class="o">;</span>
  <span class="k">Function</span> <span class="nf">IndexOfFile</span><span class="p">(</span><span class="n">AName</span><span class="o">:</span> <span class="k">String</span><span class="p">)</span> <span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
  <span class="k">Function</span> <span class="nf">FileByName</span><span class="p">(</span><span class="n">AName</span><span class="o">:</span> <span class="k">String</span><span class="p">)</span> <span class="o">:</span> <span class="n">TUploadedFile</span><span class="o">;</span>
  <span class="k">Function</span> <span class="nf">FindFile</span><span class="p">(</span><span class="n">AName</span><span class="o">:</span> <span class="k">String</span><span class="p">)</span> <span class="o">:</span> <span class="n">TUploadedFile</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">Files</span><span class="p">[</span><span class="kp">Index</span><span class="o">:</span> <span class="kt">Integer</span><span class="p">]</span> <span class="o">:</span> <span class="n">TUploadedFile</span> <span class="kp">read</span> <span class="nf">GetFile</span> <span class="kp">Write</span> <span class="nf">SetFile</span><span class="o">;</span> <span class="kp">default</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>Each <b>TUploadedFile</b> itself has several properties:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">TUploadedFile</span> <span class="o">=</span> <span class="k">Class</span><span class="p">(</span><span class="n">TCollectionItem</span><span class="p">)</span>
<span class="o">...</span>
<span class="kp">Public</span>
  <span class="k">Destructor</span> <span class="nf">Destroy</span><span class="o">;</span> <span class="kp">override</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">FieldName</span><span class="o">:</span> <span class="k">String</span> <span class="kp">Read</span> <span class="nf">FFieldName</span> <span class="kp">Write</span> <span class="nf">FFieldName</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">FileName</span><span class="o">:</span> <span class="k">String</span> <span class="kp">Read</span> <span class="nf">FFileName</span> <span class="kp">Write</span> <span class="nf">FFileName</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">Stream</span><span class="o">:</span> <span class="n">TStream</span> <span class="kp">Read</span> <span class="nf">GetStream</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">Size</span><span class="o">:</span> <span class="kt">Int64</span> <span class="kp">Read</span> <span class="nf">FSize</span> <span class="kp">Write</span> <span class="nf">FSize</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">ContentType</span><span class="o">:</span> <span class="k">String</span> <span class="kp">Read</span> <span class="nf">FContentType</span> <span class="kp">Write</span> <span class="nf">FContentType</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">Disposition</span><span class="o">:</span> <span class="k">String</span> <span class="kp">Read</span> <span class="nf">FDisposition</span> <span class="kp">Write</span> <span class="nf">FDisposition</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">LocalFileName</span><span class="o">:</span> <span class="k">String</span> <span class="kp">Read</span> <span class="nf">FLocalFileName</span> <span class="kp">Write</span> <span class="nf">FLocalFileName</span><span class="o">;</span>
  <span class="k">Property</span> <span class="py">Description</span><span class="o">:</span> <span class="k">String</span> <span class="kp">Read</span> <span class="nf">FDescription</span> <span class="kp">Write</span> <span class="nf">FDescription</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>They should be descriptive enough, with the exception of <b>FileName</b> and <b>LocalFileName</b>. <b>FileName</b> is
the original file <b>name</b> as uploaded from client, <b>LocalFileName</b> is the file <b>path</b> in the server where the file
is temporarily stored. Note the difference in bold terms above.
</p><p>Again, reusing the same request handler:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">DataModuleRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
 <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">var</span>
  <span class="n">n</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
  <span class="n">f</span><span class="o">:</span> <span class="n">TUploadedFile</span><span class="o">;</span>
  <span class="n">i</span><span class="o">:</span> <span class="kt">Integer</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">n</span> <span class="o">:=</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">Files</span><span class="o">.</span><span class="n">Count</span><span class="o">;</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span>
    <span class="k">with</span> <span class="n">AResponse</span><span class="o">.</span><span class="n">Contents</span> <span class="k">do</span>
    <span class="k">begin</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;form id="form" action="'</span> <span class="o">+</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">URI</span> <span class="o">+</span> <span class="s">'" method="POST" enctype="multipart/form-data"&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;label for="name"&gt;Drag n drop or click to add file:&lt;/label&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;input type="file" name="input" /&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;input type="submit" value="Send" /&gt;'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">Add</span><span class="p">(</span><span class="s">'&lt;/form&gt;'</span><span class="p">)</span><span class="o">;</span>
    <span class="k">end</span>
  <span class="k">else</span>
  <span class="k">begin</span>
    <span class="n">f</span> <span class="o">:=</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">Files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">;</span>
    <span class="n">AResponse</span><span class="o">.</span><span class="n">Contents</span><span class="o">.</span><span class="n">LoadFromStream</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">Stream</span><span class="p">)</span><span class="o">;</span>
  <span class="k">end</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>drag n drop a file (preferably text, as it's will be rendered as text) to the input file field (or click the respective
button) then click <b>Send</b> button. The file content should be displayed.
</p>
<h2><span class="mw-headline" id="Cookies">Cookies</span></h2>
<h3><span class="mw-headline" id="Setting">Setting</span></h3>
<p><a href="https://wiki.freepascal.org/File:cookie_session_Object_Pascal.png" class="image" title="The &quot;cookie&quot; concept, invented by Netscape in 1994, to allow the HTTP server to identify all its clients."><img alt="The &quot;cookie&quot; concept, invented by Netscape in 1994, to allow the HTTP server to identify all its clients." src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/cookie_session_Object_Pascal.png" width="50" height="57"></a><br>
</p><p>Cookies are browser responsibility to save and keep, therefore server need to send it as part of the
response in order to set one. <b>AResponse.Cookies</b> contains a list of cookies to be sent. It's a descendant of
<b>TCollection</b>, respectively the contained <b>TCookie</b> is a descendant of <b>TCollectionItem</b>. Therefore, you
can use TCollection way of managing items to manipulate it.
</p><p>Here's an example:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">DataModuleRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
 <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">var</span>
  <span class="n">C</span><span class="o">:</span> <span class="n">TCookie</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">C</span> <span class="o">:=</span> <span class="n">AResponse</span><span class="o">.</span><span class="n">Cookies</span><span class="o">.</span><span class="n">Add</span><span class="o">;</span>
  <span class="n">C</span><span class="o">.</span><span class="n">Name</span> <span class="o">:=</span> <span class="s">'mycookie'</span><span class="o">;</span>
  <span class="n">C</span><span class="o">.</span><span class="n">Value</span> <span class="o">:=</span> <span class="s">'somevalue'</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>You won't see any output in your browser. But if you use some kind of developer tools (Chrome has one
built-in), you can see the response header:
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_cookie_set.png" class="image" title="Set-Cookie response header in Chrome's developer tools"><img alt="Set-Cookie response header in Chrome's developer tools" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_cookie_set.png" width="580" height="276"></a>
</p><p>Note that cookie has attributes, so Name and Value is not the only two you can set. Browse TCookie
interface to see what properties are supported.
</p>
<h3><span class="mw-headline" id="Getting">Getting</span></h3>
<p>Once you give <b>Set-Cookie</b> header above, subsequent request to your site will contain additional header
containing the value you ask to set previously:
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_cookie_get.png" class="image" title="Cookie request header in Chrome's developer tools"><img alt="Cookie request header in Chrome's developer tools" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_cookie_get.png" width="581" height="261"></a>
</p><p>Fortunately, the way to read it is no different from GET &amp; POST data. The related property is
<b>ARequest.CookieFields</b>. To read previously set cookie:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">DataModuleRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
 <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">AResponse</span><span class="o">.</span><span class="n">Contents</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="s">'&lt;p&gt;Cookie get: '</span> <span class="o">+</span> <span class="n">ARequest</span><span class="o">.</span><span class="n">CookieFields</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="s">'mycookie'</span><span class="p">]</span> <span class="o">+</span> <span class="s">'&lt;/p&gt;'</span><span class="p">)</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<h2><span class="mw-headline" id="Sessions">Sessions</span></h2>
<p>TFPWebModule is a descendant of TSessionHTTPModule, so it has session management capability. Session
is module based, so each module may choose to use or not to use session management.
</p><p>Session is implemented in abstract manner. By default, no implementation is provided. One sample
implementation using .ini files is given in <b>iniwebsession</b> unit. You must have this unit in your project or
implement one for session management to work. If you decide to implement one, basically you need to
extend and implement abstract methods in <b>TCustomSession</b> and <b>TSessionFactory</b> classes.
</p>
<h3><span class="mw-headline" id="Activating">Activating</span></h3>
<p>To activate session management, set <b>CreateSession</b> property to true. Session will be started prior to
request handling. In case of a new session, <b>OnNewSession</b> will be called. Initialize your session variables
here.
</p>
<h3><span class="mw-headline" id="Session_Variables_Manipulation">Session Variables Manipulation</span></h3>
<p>Session variables are provided as <b>Session.Variables</b> (nb: the 
Session object is the equivalent of the $_SESSION array used in Php). 
This is a string to string map like structure, so you
can read / write it like:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Session</span><span class="o">.</span><span class="n">Variables</span><span class="p">[</span><span class="s">'myvar'</span><span class="p">]</span> <span class="o">:=</span> <span class="n">myvar</span><span class="o">;</span> <span class="c1">// write</span>
<span class="o">...</span>
<span class="n">myvar</span> <span class="o">:=</span> <span class="n">Session</span><span class="o">.</span><span class="n">Variables</span><span class="p">[</span><span class="s">'myvar'</span><span class="p">]</span><span class="o">;</span> <span class="c1">// read</span>
</pre></div>
<p>Setting a variable to empty string does <b>NOT</b> remove it. If you really want to remove a variable, call
<b>Session.RemoveVariable</b> instead.
</p>
<h3><span class="mw-headline" id="Terminating">Terminating</span></h3>
<p>Call <b>Session.Terminate</b> whenever you want to terminate a session (e.g.: user logout). Session will also
automatically expire if the next request comes after <b>Session.TimeOutMinutes</b> since last request. When
session terminates, <b>OnSessionExpired</b> will be called. Do whatever cleanup you need there.
</p>
<h2><span class="mw-headline" id="Routing">Routing</span></h2>
<p>Since FPC 3.0.4, a new routing mechanism has been implemented. Instead of maintaining backward
compatibility, it is decided that the new routing will be the default. Thus, any old code&nbsp; (or new code
depending on old routing) must be ported by adding:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Application</span><span class="o">.</span><span class="n">LegacyRouting</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
</pre></div>
<p>in the .lpr.
</p>
<h3><span class="mw-headline" id="Old_Mechanism">Old Mechanism</span></h3>
<h4><span class="mw-headline" id="Using_Multiple_Modules">Using Multiple Modules</span></h4>
<p>You can have multiple modules in your app. Click "File" menu, then click "New...". A dialog shall appear,
select "Web Module" from the treeview.
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_new_module.png" class="image" title="Add new web module"><img alt="Add new web module" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_new_module.png" width="580" height="430"></a>
</p><p>then click OK.
</p><p><br>
With multiple modules exist in your app, you can no longer request just with /. The framework will not be
able to magically select which module must serve the response, so there are two ways to state which
module you'd like to call:
</p>
<ul><li>/&lt;module name&gt;</li>
<li>/?module=&lt;module name&gt;</li></ul>
<p>In the 2nd format, you can change "module" (which is the default value) to whatever valid query string key
by modifying <b>Application.ModuleVariable</b>.
</p>
<h4><span class="mw-headline" id="Using_Actions">Using Actions</span></h4>
<p>So far, we've only used web modules with single request handler. This doesn't scale much as your web app
gets more and more complex. Moreover, some features might have shared properties and be better
logically grouped, e.g.:
</p>
<ul><li>Account module
<ul><li>Login action</li>
<li>Logout action</li>
<li>Register action</li></ul></li>
<li>Product module
<ul><li>Create action</li>
<li>Update action</li>
<li>Delete action</li>
<li>Details action</li></ul></li></ul>
<h5><span class="mw-headline" id="Request_Handling_Flow">Request Handling Flow</span></h5>
<p>Before using action, it is important to know fpWeb request handling flow. Failing to do so might render your
action useless because it's always your data module that handles the request. How could that be? Going
back a few chapters, remember the <b>Handled&nbsp;:= true</b> that we always did before? Now this is where
<b>Handled</b> parameter comes into play.
</p><p><b>Every</b> requests will go through module's <b>OnRequest</b> first, regardless the requested action. Only if it does
<b>not</b> set Handled to true, web action's OnRequest is executed.
</p><p>In general, the request flow is:
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_request_flow.png" class="image" title="fpWeb request flow"><img alt="fpWeb request flow" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_request_flow.png" width="566" height="772"></a>
</p><p>Notice the "Our Concern" box, that's what we're going to put our attention at.
</p>
<h5><span class="mw-headline" id="Add_Actions_to_Web_Modules">Add Actions to Web Modules</span></h5>
<p>To add an action, select the web module then go to object inspector. In the properties tab, select Actions
and click the button on the second column.
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_manage_actions.png" class="image" title="Manage actions button in object inspector"><img alt="Manage actions button in object inspector" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_manage_actions.png" width="269" height="434"></a>
</p><p>A popup window shall appear where you can add, delete and reorder actions.
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_edit_actions.png" class="image" title="Manage actions button in popup window"><img alt="Manage actions button in popup window" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_edit_actions.png" width="200" height="330"></a>
</p><p>Press Add, a new action shall appear in the list. Select it then go to object inspector. It will currently show
properties and events of that newly created action. Rename the Name property (this will be the name you
write in the URL, so give it a short, simple but descriptive name) as you wish, I will choose "Hello". Move on
to events tab, do the same as OnRequest for module, click button on the right of OnRequest row to create
the request handler.
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_action_onrequest.png" class="image" title="Creating web action's OnRequest handler in the object inspector"><img alt="Creating web action's OnRequest handler in the object inspector" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_action_onrequest.png" width="267" height="429"></a>
</p><p>You will be presented in the same OnRequest interface, but this one handles web action instead of web
module. Whatever you can do in web module's OnRequest can be done here as well. Copy the method body
from the "Hello, World!" section.
</p><p>Remember to remove <b>Handled&nbsp;:= true</b> from the previous web module's <b>OnRequest</b> body (or remove the
event completely) for the action to take care of the request handling.
</p><p>Run your project, and fire up your browser. Now, since the request handling is delegated to web action, you
can no longer just request /, but you need /&lt;action name&gt; or &lt;Module's ActionVar property&gt;=&lt;action
name&gt;. Note that &lt;Module's ActionVar property&gt; has a default value of empty string, unlike
<b>Application.ModuleVariable</b> which has "module" as the default value. So, by default, you can only use
the /&lt;action name&gt; form.
</p><p>If you have multiple modules, then you have a variety of options:
</p>
<ul><li>/&lt;module name&gt;/&lt;action name&gt;</li>
<li>/&lt;module name&gt;?action=&lt;action name&gt;</li>
<li>/&lt;action name&gt;?module=&lt;module name&gt;</li>
<li>/?module=&lt;module name&gt;&amp;action=&lt;action name&gt;</li></ul>
<p>Note that as soon as a module have at least one action, /&lt;module or action name&gt; alone will by default
map to /&lt;action name&gt;. To change the behavior such that it maps to /&lt;module name&gt; by default, set
<b>Application.PreferModuleName</b> to <b>true</b>. In case of multiple modules, if no module name given, then the
default module will handle the given action. To change the behavior such that module name must be
explicitly given, set <b>Application.AllowDefaultModule</b> to <b>false</b>.
</p><p>The following tables summarize what will happen based on the two properties:
</p>
<table class="wikitable">
<tbody><tr>
<th colspan="2" rowspan="2">/&lt;module or action name&gt;
</th>
<th colspan="2">Application.PreferModuleName
</th></tr>
<tr>
<td>true
</td>
<td>false
</td></tr>
<tr>
<th rowspan="2">Application.AllowDefaultModule
</th>
<td>true
</td>
<td>/&lt;module name&gt;
</td>
<td>/&lt;default module&gt;/&lt;action name&gt;
</td></tr>
<tr>
<td>false
</td>
<td>/&lt;module name&gt;
</td>
<td>ERROR
</td></tr></tbody></table>
<h5><span class="mw-headline" id="Default_Action">Default Action</span></h5>
<p>Remember the previous diagram, the "Delegate request handling to actions" is actually not so simple, but if
we expand that diagram, the image will be too big to fit. So, here's the diagram of that part:
</p><p><a href="https://wiki.freepascal.org/File:fpwebtutorial_request_delegation_flow.png" class="image" title="Request delegation to action flow"><img alt="Request delegation to action flow" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/fpwebtutorial_request_delegation_flow.png" width="644" height="809"></a>
</p><p>Two important things from the flow: DefActionWhenUnknown and a default action. The former is a web
module's property while the latter corresponds to Default property of an action. In the latter case, in case
there are more than two actions having Default property set to true, the the action order (as how it's
shown in the manage actions popup window) will be considered to decide which is the default action. The
two properties forms what the application should do if no matching action found for a given request.
</p><p>The following tables summarize what will happen based on the two properties:
</p>
<table class="wikitable">
<tbody><tr>
<th colspan="2" rowspan="2">Request with invalid action name
</th>
<th colspan="2">DefActionWhenUnknown
</th></tr>
<tr>
<td>true
</td>
<td>false
</td></tr>
<tr>
<th rowspan="2">Action.Default
</th>
<td>true
</td>
<td>Request handled by default action
</td>
<td>Error: No action found for action: &lt;action name&gt;
</td></tr>
<tr>
<td>false
</td>
<td>Error: Invalid action name and no default action
</td>
<td>Error: No action found for action: &lt;action name&gt;
</td></tr></tbody></table>
<p><br>
</p>
<table class="wikitable">
<tbody><tr>
<th colspan="2" rowspan="2">Request without action name, i.e.: /
</th>
<th colspan="2">DefActionWhenUnknown
</th></tr>
<tr>
<td>true
</td>
<td>false
</td></tr>
<tr>
<th rowspan="2">Action.Default
</th>
<td>true
</td>
<td>Request handled by default action
</td>
<td>Request handled by default action
</td></tr>
<tr>
<td>false
</td>
<td>Error: No action name and no default action
</td>
<td>Error: No action name and no default action
</td></tr></tbody></table>
<p>In case of error response above, a stack trace shall follow, complete with line number information if you
build your app with -gl. We'll see later on how to create custom handler for this (stacktrace are no good for
production). But for now, make sure you understand the concept of web module and web action, especially
the request flow. Play around until you think you're ready for next section.
</p>
<h3><span class="mw-headline" id="New_Mechanism">New Mechanism</span></h3>
<p>The new mechanism is extremely flexible and works even without data modules (old mechanism only works
with data modules).
</p><p>A dedicated unit for this routing is provided as <b>httproute</b> (add this to uses clause of program / unit where
you want to register routes). The unit contains a function <b>HTTPRouter</b> that will return singleton object
responsible for application's route management and has <b>RegisterRoute</b> method to register your route.
</p>
<h4><span class="mw-headline" id="Route_Syntax">Route Syntax</span></h4>
<p>The first parameter of <b>HTTPRouter.RegisterRoute</b> is the route that will be matched against incoming
request. It can be as simple as&nbsp;<b>*</b> above, which means 0 or more paths or simply any paths, up to as
complex as&nbsp;<b>/api/v1/:resource/*</b> which means <b>REQUEST_URI</b> header should start
with <b>/api/v1/</b> followed by something else that will be bound to variable named&nbsp; resource and finally
ended with 0 or more paths. It will match:
</p>
<ul><li>/api/v1/products</li>
<li>/api/v1/products/1</li>
<li>/api/v1/products/1/clone</li>
<li>/api/v1/products/something/else/that/is/really/long/and/silly</li></ul>
<p>but not:
</p>
<ul><li>/api/v1</li>
<li>/excuse/me/api/v1/products</li></ul>
<p>Basically there are only 3 special characters:
</p>
<ul><li>* &nbsp;denoting 0 or more paths</li>
<li>&nbsp;:param &nbsp;denoting a part</li>
<li>/ &nbsp;denoting part separator</li></ul>
<p>your route will be composed of these 3 characters, plus everything else that made up a route.&nbsp;
</p>
<h4><span class="mw-headline" id="Registering_a_Route">Registering a Route</span></h4>
<p>The 2nd, 3rd or 4th parameter (depending on whether you want to handle specific HTTP method and/or
pass additional data to it) of&nbsp;<b>HTTPRouter.RegisterRoute</b> is overloaded with several possibilities:
</p>
<ul><li>Callback procedure</li></ul>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">TRouteCallback</span> <span class="o">=</span> <span class="k">Procedure</span><span class="p">(</span><span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span> <span class="n">AResponse</span><span class="p">)</span><span class="o">;</span>
</pre></div>
<ul><li>Callback event</li></ul>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">TRouteEvent</span> <span class="o">=</span> <span class="k">Procedure</span><span class="p">(</span><span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span> <span class="n">AResponse</span><span class="p">)</span> <span class="k">of</span> <span class="k">object</span><span class="o">;</span>
</pre></div>
<ul><li>Object satisfying a (CORBA) interface</li></ul>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">IRouteInterface</span> <span class="o">=</span> <span class="k">Interface</span> <span class="p">[</span><span class="s">'{10115353-10BA-4B00-FDA5-80B69AC4CAD0}'</span><span class="p">]</span>
  <span class="k">Procedure</span> <span class="nf">HandleRequest</span><span class="p">(</span><span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span> <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="p">)</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<ul><li>Object extending abstract router class</li></ul>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">TRouteObject</span> <span class="o">=</span> <span class="k">Class</span><span class="p">(</span><span class="kt">TObject</span><span class="o">,</span> <span class="n">IRouteInterface</span><span class="p">)</span>
<span class="kp">Public</span>
  <span class="k">Procedure</span> <span class="nf">HandleRequest</span><span class="p">(</span><span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span> <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="p">)</span><span class="o">;</span> <span class="kp">virtual</span><span class="o">;</span> <span class="kp">abstract</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>

<span class="n">TRouteObjectClass</span> <span class="o">=</span> <span class="k">Class</span> <span class="k">of</span> <span class="n">TRouteObject</span><span class="o">;</span>
</pre></div>
<p>By default, if 2nd parameter is not a&nbsp;<b>TRouteMethod</b>, then all HTTP methods will match. Use one
of&nbsp; <b>rmUnknown, rmAll, rmGet, rmPost, rmPut, rmDelete, rmOptions, rmHead, rmTrace</b> to match only a
specific HTTP method.
</p><p>Registration order matters. If there are two or more routes matching the current request, the earlier
registered one will handle it.
</p><p>In this new mechanism, standalone Hello, World! program can be as simple as:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">uses</span>
  <span class="n">fphttpapp</span><span class="o">,</span> <span class="n">httpdefs</span><span class="o">,</span> <span class="n">httproute</span><span class="o">;</span>
<span class="k">procedure</span> <span class="nf">DoHello</span><span class="p">(</span><span class="n">ARequest</span><span class="o">:</span><span class="n">TRequest</span><span class="o">;</span> <span class="n">AResponse</span> <span class="o">:</span> <span class="n">TResponse</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">AResponse</span><span class="o">.</span><span class="n">Content</span><span class="o">:=</span><span class="s">'&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello,World!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;'</span>
<span class="k">end</span><span class="o">;</span>

<span class="k">begin</span>
  <span class="n">HTTPRouter</span><span class="o">.</span><span class="n">RegisterRoute</span><span class="p">(</span><span class="s">'*'</span><span class="o">,</span> <span class="o">@</span><span class="n">DoHello</span><span class="p">)</span><span class="o">;</span>
  <span class="n">Application</span><span class="o">.</span><span class="n">Port</span> <span class="o">:=</span> <span class="mi">9000</span><span class="o">;</span>
  <span class="n">Application</span><span class="o">.</span><span class="n">Initialize</span><span class="o">;</span>
  <span class="n">Application</span><span class="o">.</span><span class="n">Run</span><span class="o">;</span>
<span class="k">end</span><span class="o">.</span>
</pre></div>
<h2><span class="mw-headline" id="Using_Templates">Using Templates</span></h2>
<p>fpWeb has integrated support for FPTemplate, Free Pascal's generic templating engine. It doesn't have to be
used from web application context, but with integrated support things will be easier a bit. At least the
memory management can be ignored as the module will take care of it.
</p><p>There are two levels where one can use templates at: action and module. The full RAD support is
incomplete, so you need to go down to hand coding at some points.
</p><p>There are two modes of operation: non-parameterized and parameterized. The active mode is controlled by
<b>AllowTagParams</b> property, which should be obvious enough what value refers to what mode.
</p><p>Template string can be given from a file through <b>FileName</b> property or a direct string through <b>Template</b>
property. Template.Template, I know it sounds weird&nbsp;:) If both are filled then FileName will take
precedence.
</p><p>The two properties: <b>StartDelimiter</b> and <b>EndDelimiter</b> define how the engine should recognize a
template tag. For instance, if you have:
</p>
<ul><li>StartDelimiter = '{+'</li>
<li>EndDelimiter = '+}'</li></ul>
<p>then a string '{+title+}' defines a template tag named 'title'. Note that spaces are significant, so '{+ title +}'
defines a template tag named ' title ' instead of just 'title'.
</p><p>Special for parameterized mode, additional three properties: <b>ParamStartDelimiter</b>, <b>ParamEndDelimiter</b>
and <b>ParamValueSeparator</b> defines how the engine should recognize a template tag parameter. For
instance, if you have:
</p>
<ul><li>ParamStartDelimiter = '[-'</li>
<li>ParamEndDelimiter = '-]'</li>
<li>ParamValueSeparator = '='</li></ul>
<p>then a string '{+data [-p=v-][-a=b-] +}' defines a template tag named 'data' with parameter 'p' of value 'v' and
parameter 'a' of value 'b'. This can be used to pass template level parameter such as expected date format,
header-row-footer for customizable output presentation, name of file, etc. you decide.
</p><p>As a consequence of different way of operation, the core event where the template works is different, too.
Non-parameterized will use <b>OnGetParam</b> while the parameterized will use <b>OnReplaceTag</b>. The two has of
course different interface:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">Type</span>
  <span class="c1">// OnGetParam: for simple template tag support only (ex: {Name})</span>
  <span class="n">TGetParamEvent</span> <span class="o">=</span> <span class="k">Procedure</span><span class="p">(</span>
    <span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span>
    <span class="k">Const</span> <span class="n">ParamName</span><span class="o">:</span> <span class="k">String</span><span class="o">;</span>
    <span class="n">Out</span> <span class="n">AValue</span><span class="o">:</span> <span class="k">String</span>
  <span class="p">)</span> <span class="k">Of</span> <span class="k">Object</span><span class="o">;</span>
  <span class="c1">// OnReplaceTag: for tags with parameters support</span>
  <span class="n">TReplaceTagEvent</span> <span class="o">=</span> <span class="k">Procedure</span><span class="p">(</span>
    <span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span>
    <span class="k">Const</span> <span class="n">TagString</span><span class="o">:</span> <span class="k">String</span><span class="o">;</span>
    <span class="n">TagParams</span><span class="o">:</span> <span class="n">TStringList</span><span class="o">;</span>
    <span class="n">Out</span> <span class="n">ReplaceText</span><span class="o">:</span> <span class="k">String</span>
  <span class="p">)</span> <span class="k">Of</span> <span class="k">Object</span><span class="o">;</span>
</pre></div>
<p>In <b>OnGetParam</b>, you check for <b>ParamName</b>, then assign <b>AValue</b> accordingly. i.e., if you want tag 'title' to be
replaced by 'My App', then fill in the method with:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">// use Trim() if you want the spaces around tag to be insignificant</span>
<span class="k">case</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span> <span class="k">of</span>
  <span class="s">'title'</span><span class="o">:</span> <span class="n">AValue</span> <span class="o">:=</span> <span class="s">'My App'</span><span class="o">;</span>
<span class="k">else</span>
  <span class="n">AValue</span> <span class="o">:=</span> <span class="s">'UNKNOWN'</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>In <b>OnReplaceTag</b>, you check for <b>TagString</b> and optionally <b>TagParams</b>, then assign <b>ReplaceText</b>
accordingly. i.e., if you want tag 'datetime' to be replaced by current time with parameter 'datetimeformat'
to specify how the date and time should be formatted, then fill in the method like this:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">// use Trim() if you want the spaces around tag to be insignificant</span>
<span class="k">case</span> <span class="nb">Trim</span><span class="p">(</span><span class="n">TagString</span><span class="p">)</span> <span class="k">of</span>
  <span class="s">'datetime'</span><span class="o">:</span> <span class="n">AValue</span> <span class="o">:=</span> <span class="nb">FormatDateTime</span><span class="p">(</span><span class="n">TagParams</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="s">'datetimeformat'</span><span class="p">]</span><span class="o">,</span><span class="nb">Now</span><span class="p">)</span><span class="o">;</span>
<span class="k">else</span>
  <span class="n">AValue</span> <span class="o">:=</span> <span class="s">'UNKNOWN'</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<h3><span class="mw-headline" id="At_Action_Level">At Action Level</span></h3>
<p>Create/select an action, then go to object inspector. You will see a subcomponent property named
<b>Template</b>. This template is a normal <b>TFPTemplate</b> instance. Expand it and fill in the properties as
explained above. Now go to Events tab, again expand <b>Template</b>, you will see the two events. Fill the one
based on your value of <b>AllowTagParams</b> property.
</p><p>NOTE: If your Lazarus cannot autocomplete the event, try writing the name manually in the edit box then
click the ... button. This is a bug in present Lazarus which may be fixed in the future.
</p><p>At this level, template with a content is not automatically set as request handler. It might change in the
future, but let's deal with its current state. Fill in <b>OnRequest</b> event of the action, then fill it with:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">with</span> <span class="n">Actions</span><span class="o">.</span><span class="n">CurrentAction</span> <span class="k">as</span> <span class="n">TFPWebAction</span> <span class="k">do</span>
<span class="k">begin</span>
  <span class="n">AResponse</span><span class="o">.</span><span class="n">Content</span> <span class="o">:=</span> <span class="n">Template</span><span class="o">.</span><span class="n">GetContent</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
<span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
</pre></div>
<p>The cast is required since <b>CurrentAction</b> is of type <b>TCustomWebAction</b> instead of <b>TFPWebAction</b>.
Without it, we can't access the <b>Template</b> property.
</p>
<h3><span class="mw-headline" id="At_Module_Level">At Module Level</span></h3>
<p>At module level, you currently have to do it by hand coding since no RAD support is implemented. The
linked property is ModuleTemplate . This is however not a regular <b>TFPTemplate</b> instance, but special
<b>TFPWebTemplate</b> class that's a descendant of it.
</p><p>The idea here is to have module provide a layout while the actions provide content, with the ability to
provide additional variables. It's therefore a good idea to keep <b>AllowTagParams</b> as is and assign
<b>OnGetParam</b> event **of the module** only. Do NOT assign <b>OnGetParam</b> of <b>ModuleTemplate</b> as it will
<b>never</b> be called.
</p><p>A template tag named 'content' will be replaced automatically by what content produced by action,
everything else is either replaced from internal template variables or from <b>OnGetParam</b>.
</p>
<h3><span class="mw-headline" id="Using_Separated_Template">Using Separated Template</span></h3>
<p>Despite the somewhat incomplete integration, nothing stops you from using fpTemplate (or any other
templating solutions) manually, outside from the integrated support. This could even be better in some
cases since it's modular.
</p><p><br>
</p>
<h2><span class="mw-headline" id="Using_an_html_Producer_object">Using an html Producer object</span></h2>
<p>Assuming that there is a TWebAction named act_get_my_html, you must 
ask to write in AResponse, the return of an internal bytes stream: when 
answering with html Producer objects solution, <u>we must use the methods of the writer</u>.
 It manages a memory stream for a purpose of rapidity. No string type 
here, like with the above fpTemplate solution which uses text \ string 
processing as in the regular Php way. The Producer writes in AResponse 
with a recursive " foreach " iteration, that traverses the polymorphic 
objects HTML Dom tree, composed with the hierarchy THtmlCustomElement = 
Class(TDOMElement) Classes (see unit htmlelements.pp). So, the AResponse
 is written by the parameter aWriter, with the following call:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">act_get_my_htmlRequest</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span> <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="cm">(* ask HTMLEntityProducer1 for the content of its html DOM elements: *)</span>
  <span class="n">HTMLEntityProducer1</span><span class="o">.</span><span class="n">HandleRequest</span><span class="p">(</span><span class="n">ARequest</span><span class="o">,</span> <span class="n">AResponse</span><span class="o">,</span> <span class="n">Handled</span><span class="p">)</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">True</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>Said again, it's the job of the Producer to convert its internal 
memory stream into text in the response object: that's how this pattern 
was designed, although there is a text-html rendering method named 
ProduceContent for debugging purposes only. You can override this method
 if you are writing or debugging a Producer component.
</p><p>Here is an example, always with an html Producer object, allowing
 to create a web application in the "RAD way", i.e. with the drag-drop 
of the HTMLEntityProducer component from the pallet:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">procedure</span> <span class="nc">TFPWebModule1</span><span class="o">.</span><span class="nf">HTMLEntityProducer1WriteEntity</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="n">THTMLContentProducer</span><span class="o">;</span> <span class="n">aWriter</span><span class="o">:</span> <span class="n">THTMLWriter</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>

  <span class="n">aWriter</span><span class="o">.</span><span class="n">startHeader</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">Meta</span><span class="p">(</span><span class="s">''</span><span class="o">,</span><span class="s">'Content-Type'</span><span class="o">,</span><span class="s">'text/html; charset=UTF-8'</span><span class="p">)</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'My web page'</span><span class="p">)</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="s">'stylesheet'</span><span class="o">,</span><span class="s">'stylesheet.css'</span><span class="o">,</span><span class="s">'text/css'</span><span class="o">,</span><span class="s">'screen'</span><span class="p">)</span><span class="o">;</span>
  <span class="n">aWriter</span><span class="o">.</span><span class="n">EndHeader</span><span class="o">;</span>

  <span class="n">aWriter</span><span class="o">.</span><span class="n">Startbody</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">Startparagraph</span><span class="o">;</span>
      <span class="n">aWriter</span><span class="o">.</span><span class="n">heading2</span><span class="p">(</span><span class="s">'Hello, world from inside §1:'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">aWriter</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">'Here is text written inside the current paragraph.'</span><span class="p">)</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">Endparagraph</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">paragraph</span><span class="p">(</span><span class="s">'This is another text written inside a self "started and ended" paragraph.'</span><span class="p">)</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">Startparagraph</span><span class="o">;</span>
      <span class="n">aWriter</span><span class="o">.</span><span class="n">heading2</span><span class="p">(</span><span class="s">'Hello, world from inside §2:'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">aWriter</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="s">'Here is the final text.'</span><span class="p">)</span><span class="o">;</span>
      <span class="n">aWriter</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">src</span> <span class="o">:=</span> <span class="s">'logo.png'</span><span class="o">;</span>
      <span class="n">AnotherProducer</span><span class="o">.</span><span class="n">WriteContent</span><span class="p">(</span><span class="n">aWriter</span><span class="p">)</span><span class="o">;</span>
    <span class="n">aWriter</span><span class="o">.</span><span class="n">Endparagraph</span><span class="o">;</span>
  <span class="n">aWriter</span><span class="o">.</span><span class="n">Endbody</span><span class="o">;</span>

<span class="k">end</span><span class="o">;</span>
</pre></div>
<p>The TWebAction.ContentProducer property allows to couple a THTTPContentProducer to its web action exposed via a URI on the net.
</p><p>[ToDo: there is no official documentation about the components 
"RAD way" of fpWeb (html producer, html provider, html adapter, html 
formatter, etc)]
</p>
<h2><span class="mw-headline" id="Tips_and_Tricks">Tips and Tricks</span></h2>
<h3><span class="mw-headline" id="Returning_Different_HTTP_Response_Code">Returning Different HTTP Response Code</span></h3>
<p>By default, fpWeb will return HTTP 200 OK to indicate successful request handling. This surely is not always
the case, as user input might not be as what we expected. To do so, set <b>AResponse.Code</b> in your request
handler to the code you want to return.
</p>
<h3><span class="mw-headline" id="Redirect_Request_to_Different_URL">Redirect Request to Different URL</span></h3>
<p>A common flow after a successful login is to redirect user to his account page. This can be done by calling
AResponse.SendRedirect in your request handler, supplying the URL to redirect request to.
</p>
<h3><span id="Serving_Static_Files_(Embedded_Web_Server)"></span><span class="mw-headline" id="Serving_Static_Files_.28Embedded_Web_Server.29">Serving Static Files (Embedded Web Server)</span></h3>
<p>Remember the dialog in the <a href="#Hello.2C_World.21">#Hello, World!</a> section after you select HTTP server Application? If you tick
"Register location to serve files from" you can fill "Location" (the URI segment, must not contain any slashes)
and "Directory" (physical directory in your computer, must exist at runtime) and the wizard will simply add:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">RegisterFileLocation</span><span class="p">(</span><span class="s">'&lt;Location&gt;'</span><span class="o">,</span><span class="s">'&lt;Directory&gt;'</span><span class="p">)</span><span class="o">;</span>
</pre></div>
<p>to the beginning of your .lpr and add the unit <b>fpwebfile</b> to the uses clause. You can actually do this by hand anytime and also register multiple times for
different locations / directories. After this you can request <b>/&lt;Location&gt;/&lt;any filename under</b>
Directory&gt;<b> and it will be served automatically. Note that the mimetype of the file is determined by</b>
fpmimetypes. Call <b>MimeTypes.LoadFromFile</b> with your mime.types file in order to give correct mimetype
based on its extension. Otherwise, the file will always be served as <b>application/octet-stream</b> which
means the browser will download it instead of interpreting it (especially important for JavaScript and CSS
files).
</p><p>You can grab a complete mime.types here <a rel="nofollow" class="external free" href="http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/conf/mime.types?&amp;view=co">http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/conf/mime.types?&amp;view=co</a>
</p><p>In Lazarus 2.0.6 or newer you must add at the top of your program the full path of the mime.types file
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">begin</span>
  <span class="n">MimeTypesFile</span> <span class="o">:=</span> <span class="n">Application</span><span class="o">.</span><span class="n">Location</span> <span class="o">+</span> <span class="s">'mime.txt'</span><span class="o">;</span>
</pre></div>
<p>Take into consideration that the default path coming with the project is lib\$(TargetCPU)-$(TargetOS)
</p><p>For example httpproject\lib\i386-win32\mime.txt
</p>
<h3><span class="mw-headline" id="Centralize_Management_of_Configuration_and_Modules">Centralize Management of Configuration and Modules</span></h3>
<p>By default, the program file (.lpr) is the one that contains protocol unit. This limits the ability to use
<b>Application</b> object from other contexts such as from web modules. Fortunately, it's not difficult to
refactor to have what we want. We remove <b>RegisterHTTPModule</b> calls from web modules' units and left
out the .lpr to empty main block with single unit identifier in the uses clause, we name it: brokers. The unit
contains:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">unit</span> <span class="n">Brokers</span><span class="o">;</span>

<span class="cm">{$mode objfpc}{$H+}</span>

<span class="k">interface</span>

<span class="cm">{ $define cgi}</span>
<span class="cm">{ $define fcgi}</span>
<span class="cm">{$define httpapp}</span>

<span class="k">uses</span>
  <span class="n">CustWeb</span><span class="o">;</span>

<span class="k">function</span> <span class="nf">GetApp</span><span class="o">:</span> <span class="n">TCustomWebApplication</span><span class="o">;</span> <span class="k">inline</span><span class="o">;</span>

<span class="k">implementation</span>

<span class="k">uses</span>
  <span class="cm">{$ifdef cgi}</span><span class="n">fpcgi</span><span class="cm">{$endif}</span>
  <span class="cm">{$ifdef fcgi}</span><span class="n">fpfcgi</span><span class="cm">{$endif}</span>
  <span class="cm">{$ifdef httpapp}</span><span class="n">fphttpapp</span><span class="cm">{$endif}</span>
  <span class="o">,</span><span class="n">webmodule1</span>
  <span class="o">,</span><span class="n">webmodule2</span>
  <span class="o">;</span>

<span class="k">function</span> <span class="nf">GetApp</span><span class="o">:</span> <span class="n">TCustomWebApplication</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="bp">Result</span> <span class="o">:=</span> <span class="n">Application</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>

<span class="k">initialization</span>
  <span class="n">RegisterHTTPModule</span><span class="p">(</span><span class="s">'wm1'</span><span class="o">,</span> <span class="n">TWebModule1</span><span class="p">)</span><span class="o">;</span>
  <span class="n">RegisterHTTPModule</span><span class="p">(</span><span class="s">'wm2'</span><span class="o">,</span> <span class="n">TWebModule2</span><span class="p">)</span><span class="o">;</span>
  <span class="cm">{$ifndef cgi}</span>
  <span class="n">Application</span><span class="o">.</span><span class="n">Port</span> <span class="o">:=</span> <span class="mi">2015</span><span class="o">;</span>
  <span class="cm">{$endif}</span>
  <span class="n">Application</span><span class="o">.</span><span class="n">Initialize</span><span class="o">;</span>
  <span class="n">Application</span><span class="o">.</span><span class="n">Run</span><span class="o">;</span>
<span class="k">end</span><span class="o">.</span>
</pre></div>
<p>This way, we can control over web module registration and also provide an API to get <b>Application</b> object
(casted as <b>TCustomWebApplication</b>), while still easily switch between protocol implementations, in a single
place.
</p>
<h3><span id="Terminating_Gracefully_(FastCGI_/_Embedded_Web_Server)"></span><span class="mw-headline" id="Terminating_Gracefully_.28FastCGI_.2F_Embedded_Web_Server.29">Terminating Gracefully (FastCGI / Embedded Web Server)</span></h3>
<p>Instead of Ctrl+C-ing your app, there is a way for your app to terminate gracefully, doing whatever cleanup it
needs, by calling <b>Application.Terminate</b>. You might need to use previous trick to easily access the
<b>Application</b> object. A common implementation is to provide a specific password protected module /
action that calls the Terminate method. You may choose whatever way you want, though.
</p>
<h3><span class="mw-headline" id="Custom_Exception_Handler">Custom Exception Handler</span></h3>
<p>[edit the May 1, 2020 =&gt; moved from a method pointer to a simple procedure.]
</p><p>To override the default exception handler, which prints 
stacktrace whenever an exception is raised (i.e.: on HTTP 404 or 500), 
and thus not good for production, you must assign
<b>Application.OnShowRequestException</b>. 
</p><p><s><i>This is a method so you will need to provide your procedure
  that implements the method and assign it by using the object. i.e.: if
 you have <b>MyExceptionHandler</b> as an
object of <b>TMyExceptionHandler</b> which has <b>MyShowRequestException</b> method, you can assign it by:
</i></s></p><s><i><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Application</span><span class="o">.</span><span class="n">OnShowRequestException</span> <span class="o">:=</span> <span class="o">@</span><span class="n">MyExceptionHandler</span><span class="o">.</span><span class="n">MyShowRequestException</span><span class="o">;</span>
</pre></div></i></s><s><i></i></s><p><s><i>don't forget to <b>.Create()</b> <b>MyExceptionHandler</b> BEFORE assigning above or you will get an
<b>EAccessViolation</b>!</i></s>
</p><p>You must provide your global procedure that implements your own 
exception handler (in production, it is advisable to replace the call 
stack by an HTTP status code and its explanation). Then, you can 
override the default exception handler, by assigning it like this:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Application</span><span class="o">.</span><span class="n">OnShowRequestException</span> <span class="o">:=</span> <span class="o">@</span><span class="n">MyShowRequestException</span><span class="o">;</span>
</pre></div>
<h3><span id="Pure_Hand_Coding_(No_Form_Designer_Required)"></span><span class="mw-headline" id="Pure_Hand_Coding_.28No_Form_Designer_Required.29">Pure Hand Coding (No Form Designer Required)</span></h3>
<p>It's not a must to use Lazarus' form designer to write an fpWeb application. You can use pure hand coding
technique to write it. The secret lies in the 3rd parameter of <b>RegisterHTTPModule</b>&nbsp;: <b>SkipStreaming</b>. When
this parameter is set to true, fpWeb will not search for .lfm resource. Therefore everything must be
manually handled: property settings, event handlers, action registration, etc.
</p><p>Note that it's logical to do what's usually done through object inspector in an overriden constructor. Inside
it, call the inherited constructor supplying both AOwner and CreateMode as parameters. After that you can
set properties, assign event handlers, etc. Example:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="k">type</span>
  <span class="n">THelloWorldModule</span> <span class="o">=</span> <span class="k">class</span><span class="p">(</span><span class="n">TFPWebModule</span><span class="p">)</span>
    <span class="k">constructor</span> <span class="nf">CreateNew</span><span class="p">(</span><span class="n">AOwner</span><span class="o">:</span> <span class="n">TComponent</span><span class="o">;</span> <span class="n">CreateMode</span><span class="o">:</span> <span class="kt">Integer</span><span class="p">)</span><span class="o">;</span> <span class="kp">override</span><span class="o">;</span>
    <span class="k">procedure</span> <span class="nf">Request</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
      <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
  <span class="k">end</span><span class="o">;</span>

<span class="k">constructor</span> <span class="nc">THelloWorldModule</span><span class="o">.</span><span class="nf">CreateNew</span><span class="p">(</span><span class="n">AOwner</span><span class="o">:</span> <span class="n">TComponent</span><span class="o">;</span> <span class="n">CreateMode</span><span class="o">:</span> <span class="kt">Integer</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="k">inherited</span> <span class="n">CreateNew</span><span class="p">(</span><span class="n">AOwner</span><span class="o">,</span><span class="n">CreateMode</span><span class="p">)</span><span class="o">;</span>
  <span class="n">OnRequest</span> <span class="o">:=</span> <span class="o">@</span><span class="n">Request</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>

<span class="k">procedure</span> <span class="nc">THelloWorldModule</span><span class="o">.</span><span class="nf">Request</span><span class="p">(</span><span class="n">Sender</span><span class="o">:</span> <span class="kt">TObject</span><span class="o">;</span> <span class="n">ARequest</span><span class="o">:</span> <span class="n">TRequest</span><span class="o">;</span>
 <span class="n">AResponse</span><span class="o">:</span> <span class="n">TResponse</span><span class="o">;</span> <span class="k">var</span> <span class="n">Handled</span><span class="o">:</span> <span class="kt">Boolean</span><span class="p">)</span><span class="o">;</span>
<span class="k">begin</span>
  <span class="n">AResponse</span><span class="o">.</span><span class="n">Content</span> <span class="o">:=</span> <span class="s">'Hello, World!'</span><span class="o">;</span>
  <span class="n">Handled</span> <span class="o">:=</span> <span class="k">true</span><span class="o">;</span>
<span class="k">end</span><span class="o">;</span>
</pre></div>
<p><br>
</p>
<h3><span class="mw-headline" id="See_also">See also</span></h3>
<p>• <a class="external autonumber" href="https://www.freepascal.org/~michael/articles/#web1">[1]</a> Lazarus for the web (tutorial)<br>
• <a class="external autonumber" href="https://www.freepascal.org/~michael/articles/#web2">[2]</a> Lazarus for the web: Sessions and Templates (tutorial)<br>
This article explains a TSQLDBSession Class that manages a SQL 
connection, that inherits from a web session (in order to manage the 
histories of web session variables, within a connection-session to a 
database having row-locking capabilities).<br>
• the examples - read the text files - in your directory ...\fpc\x.x.x\source\packages\fcl-web\examples.<br>
<a href="https://wiki.freepascal.org/File:cgi-listrecords.png" class="image" title="Screenshot copy of one of the examples"><img alt="Screenshot copy of one of the examples" src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/cgi-listrecords.png" width="50" height="26"></a><br>
<br>
• XML or JSON, on ExtJS: if you want to use a more or less complex 
engine that is very "accomplished" regarding the rendering aspect of 
Javascript objects on the browser side, in addition to their 
functionalities (like ExtJS, for example, to display a db-aware grid, 
dynamic graphics, etc), this kind of solution very very often expects an
 XML or a JSON file. There are Adapter and Formatter classes (e.g. the 
classes TExtJSXMLWebdataInputAdaptor, TExtJSJSONDataFormatter).
Overall, the Adapter classes adapt the nodes of an incoming jSon or XML 
to a mapping of their TField database fields. And Formatter classes are 
mappers of each TField of a record to its node in jSon or XML format, 
before sending it out towards the browser.<br>
· <a class="external autonumber" href="https://www.freepascal.org/~michael/articles/#webdata">[3]</a> Web data formats in Lazarus/FPC <br>
· <a class="external autonumber" href="https://www.freepascal.org/~michael/articles/#extjs1">[4]</a> Practical GUI construction in ExtJS <br>
· <a class="external autonumber" href="https://www.freepascal.org/~michael/articles/#extpascal">[5]</a> Mixing ExtJS webapplications and Pascal: ExtPascal <br>
</p>
<!-- 
NewPP limit report
Cached time: 20200519115843
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.192 seconds
Real time usage: 6.149 seconds
Preprocessor visited node count: 460/1000000
Preprocessor generated node count: 820/1000000
Post‐expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 44893/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
<!-- Saved in parser cache with key lazaruswiki:pcache:idhash:16163-0!canonical and timestamp 20200519115843 and revision id 136392
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="https://wiki.lazarus.freepascal.org/index.php?title=fpWeb_Tutorial&amp;oldid=136392">https://wiki.lazarus.freepascal.org/index.php?title=fpWeb_Tutorial&amp;oldid=136392</a>"</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="https://wiki.freepascal.org/Special:Categories" title="Special:Categories">Categories</a>: <ul><li><a href="https://wiki.freepascal.org/Category:Tutorials" title="Category:Tutorials">Tutorials</a></li><li><a href="https://wiki.freepascal.org/Category:FPC" title="Category:FPC">FPC</a></li><li><a href="https://wiki.freepascal.org/Category:Lazarus" title="Category:Lazarus">Lazarus</a></li><li><a href="https://wiki.freepascal.org/Category:Networking" title="Category:Networking">Networking</a></li></ul></div></div><!-- end content --><div class="visualClear"></div></div></div></div><div id="column-one" dir="ltr" lang="en"><h2>Navigation menu</h2><div role="navigation" class="portlet" id="p-cactions" aria-labelledby="p-cactions-label"><h3 id="p-cactions-label" dir="ltr" lang="en">Views</h3><div class="pBody"><ul dir="ltr" lang="en"><li id="ca-nstab-main" class="selected"><a href="https://wiki.freepascal.org/fpWeb_Tutorial" title="View the content page [Alt+Shift+c]" accesskey="c">Page</a></li><li id="ca-talk"><a href="https://wiki.freepascal.org/Talk:fpWeb_Tutorial" rel="discussion" title="Discussion about the content page [Alt+Shift+t]" accesskey="t">Discussion</a></li><li id="ca-viewsource"><a href="https://wiki.freepascal.org/index.php?title=fpWeb_Tutorial&amp;action=edit" title="This page is protected.
You can view its source [Alt+Shift+e]" accesskey="e">View source</a></li><li id="ca-history"><a href="https://wiki.freepascal.org/index.php?title=fpWeb_Tutorial&amp;action=history" title="Past revisions of this page [Alt+Shift+h]" accesskey="h">History</a></li></ul></div></div><div role="navigation" class="portlet" id="p-personal" aria-labelledby="p-personal-label"><h3 id="p-personal-label" dir="ltr" lang="en">Personal tools</h3><div class="pBody"><ul dir="ltr" lang="en"><li id="pt-createaccount"><a href="https://wiki.freepascal.org/index.php?title=Special:CreateAccount&amp;returnto=fpWeb+Tutorial" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="https://wiki.freepascal.org/index.php?title=Special:UserLogin&amp;returnto=fpWeb+Tutorial" title="You are encouraged to log in; however, it is not mandatory [Alt+Shift+o]" accesskey="o">Log in</a></li></ul></div></div><div class="portlet" id="p-logo" role="banner"><a href="https://www.lazarus.freepascal.org/" class="mw-wiki-logo" title="Visit the main page"></a></div><div role="navigation" class="portlet generated-sidebar" id="p-navigation" aria-labelledby="p-navigation-label"><h3 id="p-navigation-label" dir="ltr" lang="en">Navigation</h3><div class="pBody"><ul dir="ltr" lang="en"><li id="n-mainpage"><a href="https://wiki.freepascal.org/Main_Page" title="Visit the main page [Alt+Shift+z]" accesskey="z">Main Page</a></li><li id="n-documentation"><a href="https://wiki.freepascal.org/Lazarus_Documentation">Documentation</a></li><li id="n-FAQ"><a href="https://wiki.freepascal.org/Lazarus_Faq">FAQ</a></li><li id="n-downloads"><a href="https://wiki.freepascal.org/Components_and_Code_examples">Downloads</a></li><li id="n-glossary"><a href="https://wiki.freepascal.org/Glossary">Glossary</a></li><li id="n-index"><a href="https://wiki.freepascal.org/Special:AllPages">Index</a></li><li id="n-recentchanges"><a href="https://wiki.freepascal.org/Special:RecentChanges" title="A list of recent changes in the wiki [Alt+Shift+r]" accesskey="r">Recent changes</a></li><li id="n-randompage"><a href="https://wiki.freepascal.org/Special:Random" title="Load a random page [Alt+Shift+x]" accesskey="x">Random page</a></li><li id="n-help"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Help:Contents" rel="nofollow" title="The place to find out">Help</a></li></ul></div></div><div role="search" class="portlet" id="p-search"><h3 id="p-search-label" dir="ltr" lang="en"><label for="searchInput">Search</label></h3><div class="pBody" id="searchBody"><form action="/index.php" id="searchform"><input type="hidden" value="Special:Search" name="title"><input type="search" name="search" placeholder="Search Lazarus wiki" title="Search Lazarus wiki [Alt+Shift+f]" accesskey="f" id="searchInput" autocomplete="off"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton">&nbsp; <input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"></form></div></div><div role="navigation" class="portlet" id="p-tb" aria-labelledby="p-tb-label"><h3 id="p-tb-label" dir="ltr" lang="en">Tools</h3><div class="pBody"><ul dir="ltr" lang="en"><li id="t-whatlinkshere"><a href="https://wiki.freepascal.org/Special:WhatLinksHere/fpWeb_Tutorial" title="A list of all wiki pages that link here [Alt+Shift+j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="https://wiki.freepascal.org/Special:RecentChangesLinked/fpWeb_Tutorial" rel="nofollow" title="Recent changes in pages linked from this page [Alt+Shift+k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="https://wiki.freepascal.org/Special:SpecialPages" title="A list of all special pages [Alt+Shift+q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://wiki.freepascal.org/index.php?title=fpWeb_Tutorial&amp;printable=yes" rel="alternate" title="Printable version of this page [Alt+Shift+p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://wiki.freepascal.org/index.php?title=fpWeb_Tutorial&amp;oldid=136392" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://wiki.freepascal.org/index.php?title=fpWeb_Tutorial&amp;action=info" title="More information about this page">Page information</a></li></ul></div></div></div><!-- end of the left (by default at least) column --><div class="visualClear"></div><div id="footer" role="contentinfo" dir="ltr" lang="en"><div id="f-copyrightico" class="footer-icons"><a href="https://sourceforge.net/"><img src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/sflogo.png" alt="" width="88" height="31"></a></div><div id="f-poweredbyico" class="footer-icons"><a href="https://www.mediawiki.org/"><img src="fpWeb%20Tutorial%20-%20Lazarus%20wiki_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"></a></div><ul id="f-list"><li id="lastmod"> This page was last edited on 19 May 2020, at 13:58.</li><li id="copyright">Content is available under <a class="external" rel="nofollow" href="https://sourceforge.net/"></a> unless otherwise noted.</li><li id="privacy"><a href="https://wiki.freepascal.org/Lazarus_wiki:Privacy_policy" title="Lazarus wiki:Privacy policy">Privacy policy</a></li><li id="about"><a href="https://wiki.freepascal.org/Lazarus_wiki:About" title="Lazarus wiki:About">About Lazarus wiki</a></li><li id="disclaimer"><a href="https://wiki.freepascal.org/Lazarus_wiki:General_disclaimer" title="Lazarus wiki:General disclaimer">Disclaimers</a></li></ul></div></div><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.192","walltime":"6.149","ppvisitednodes":{"value":460,"limit":1000000},"ppgeneratednodes":{"value":820,"limit":1000000},"postexpandincludesize":{"value":0,"limit":2097152},"templateargumentsize":{"value":0,"limit":2097152},"expansiondepth":{"value":2,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":44893,"limit":5000000},"timingprofile":["100.00%    0.000      1 -total"]},"cachereport":{"timestamp":"20200519115843","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":52});});</script>
<div at-magnifier-wrapper=""><div class="at-theme-light"><div class="at-base notranslate" translate="no"><div class="Z1-AJ" style="top: 0px; left: 0px;"></div></div></div></div><div style="display: none; font-size: 11.4667px;" class="suggestions"><div class="suggestions-results"></div><div class="suggestions-special"></div></div></body><!-- Cached 20200519123520 --></html>